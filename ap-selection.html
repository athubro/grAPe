<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.tailwindcss.com"></script>
  <title>AP Selection</title>
</head>
<body class="bg-purple-900 min-h-screen flex items-center justify-center text-white">
  <div class="bg-purple-800 p-8 rounded-2xl shadow-lg w-96">
    <h1 class="text-xl font-bold mb-4 text-center">Choose Your AP Subjects</h1>
    <form id="apForm" class="flex flex-col gap-2">
      <label><input type="checkbox" value="APUSH"> APUSH</label>
      <label><input type="checkbox" value="AP Physics"> AP Physics</label>
      <label><input type="checkbox" value="AP Calculus"> AP Calculus</label>
      <label><input type="checkbox" value="AP CS"> AP CS</label>
      <button class="bg-purple-600 mt-4 py-2 rounded-xl hover:bg-purple-500">Save</button>
    </form>
  </div>
  <script type="module">
    import { getAuth } from "firebase/auth";
    import { getFirestore, doc, updateDoc } from "firebase/firestore";
    import { app } from "./main.js";

    const auth = getAuth(app);
    const db = getFirestore(app);

    document.getElementById("apForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const selected = Array.from(document.querySelectorAll("input[type=checkbox]:checked")).map(cb => cb.value);
      const user = auth.currentUser;
      if (user) {
        await updateDoc(doc(db, "users", user.uid), {
          apSelected: true,
          subjects: selected
        });
        window.location.href = "dashboard.html";
      }
    });
  </script>
</body>
</html>
